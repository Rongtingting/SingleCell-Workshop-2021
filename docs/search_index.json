[["index.html", "SingleCell Workshop Chapter 1 Introduction", " SingleCell Workshop Yuanhua lab 2021-06-29 Chapter 1 Introduction Cell interaction and Cell differentiation trajectory Cell interaction with ligand and receptors Pseudo-time and trajectory analysis RNA velocity Cellular genetics mtDNA variants for lineage inference from single-cell omics Copy number variation estimation from scRNA-seq Nuclear SNV analysis in single-cell omics "],["env-pre.html", "Chapter 2 Prerequisites 2.1 install Anaconda 2.2 other prepare", " Chapter 2 Prerequisites 2.1 install Anaconda 2.2 other prepare You can label chapter and section titles using {#label} after them, e.g., we can reference Chapter 2. If you do not manually label them, there will be automatic labels anyway, e.g., Chapter @ref(RNA velocity). Figures and tables with captions will be placed in figure and table environments, respectively. par(mar = c(4, 4, .1, .1)) plot(pressure, type = &#39;b&#39;, pch = 19) Figure 2.1: Here is a nice figure! Reference a figure by its code chunk label with the fig: prefix, e.g., see Figure 2.1. Similarly, you can reference tables generated from knitr::kable(), e.g., see Table 2.1. knitr::kable( head(iris, 20), caption = &#39;Here is a nice table!&#39;, booktabs = TRUE ) Table 2.1: Here is a nice table! Sepal.Length Sepal.Width Petal.Length Petal.Width Species 5.1 3.5 1.4 0.2 setosa 4.9 3.0 1.4 0.2 setosa 4.7 3.2 1.3 0.2 setosa 4.6 3.1 1.5 0.2 setosa 5.0 3.6 1.4 0.2 setosa 5.4 3.9 1.7 0.4 setosa 4.6 3.4 1.4 0.3 setosa 5.0 3.4 1.5 0.2 setosa 4.4 2.9 1.4 0.2 setosa 4.9 3.1 1.5 0.1 setosa 5.4 3.7 1.5 0.2 setosa 4.8 3.4 1.6 0.2 setosa 4.8 3.0 1.4 0.1 setosa 4.3 3.0 1.1 0.1 setosa 5.8 4.0 1.2 0.2 setosa 5.7 4.4 1.5 0.4 setosa 5.4 3.9 1.3 0.4 setosa 5.1 3.5 1.4 0.3 setosa 5.7 3.8 1.7 0.3 setosa 5.1 3.8 1.5 0.3 setosa You can write citations, too. For example, we are using the bookdown package (Xie 2021) in this sample book, which was built on top of R Markdown and knitr (Xie 2015). This is a sample book written in Markdown. You can use anything that Pandocs Markdown supports, e.g., a math equation \\(a^2 + b^2 = c^2\\). The bookdown package can be installed from CRAN or Github: install.packages(&quot;bookdown&quot;) # or the development version # devtools::install_github(&quot;rstudio/bookdown&quot;) Remember each Rmd file contains one and only one chapter, and a chapter is defined by the first-level heading #. To compile this example to PDF, you need XeLaTeX. You are recommended to install TinyTeX (which includes XeLaTeX): https://yihui.org/tinytex/. References "],["pseudo-time-and-trajectory-analysis.html", "Chapter 3 Pseudo-time and trajectory analysis", " Chapter 3 Pseudo-time and trajectory analysis Here is a review of existing methods. "],["rna-velocity.html", "Chapter 4 RNA velocity", " Chapter 4 RNA velocity We describe our methods in this chapter. "],["copy-number-variation-estimation-from-scrna-seq.html", "Chapter 5 Copy number variation estimation from scRNA-seq 5.1 Method: inferCNV 5.2 Application on TNBC1 5.3 ref", " Chapter 5 Copy number variation estimation from scRNA-seq Rongting Huang 2021-06-29 5.1 Method: inferCNV InferCNV: Inferring copy number alterations from tumor single cell RNA-Seq data 5.1.1 install inferCNV Software Requirements JAGS R (&gt;3.6) In order to run infercnv, JAGS (Just Another Gibbs Sampler) must be installed. Download JAGS from https://sourceforge.net/projects/mcmc-jags/files/JAGS/4.x/ and install JAGS in your environment (windows/MAC). If you use inferCNV on server, install JAGS via conda install in your conda environment is recommended. conda install -c conda-forge jags More details refer to inferCNV wiki page Five options for installing inferCNV Option A: Install infercnv from BioConductor (preferred) if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE)) install.packages(&quot;BiocManager&quot;) BiocManager::install(&quot;infercnv&quot;) For more other options, refer to Five options for installing inferCNV Data requirements a raw counts matrix of single-cell RNA-Seq expression an annotations file which indicates which cells are tumor vs. normal. a gene/chromosome positions file File-Definitions 5.1.2 getting started If you have installed infercnv from BioConductor, you can run the example data with: library(infercnv) infercnv_obj = CreateInfercnvObject(raw_counts_matrix=system.file(&quot;extdata&quot;, &quot;oligodendroglioma_expression_downsampled.counts.matrix.gz&quot;, package = &quot;infercnv&quot;), annotations_file=system.file(&quot;extdata&quot;, &quot;oligodendroglioma_annotations_downsampled.txt&quot;, package = &quot;infercnv&quot;), delim=&quot;\\t&quot;, gene_order_file=system.file(&quot;extdata&quot;, &quot;gencode_downsampled.EXAMPLE_ONLY_DONT_REUSE.txt&quot;, package = &quot;infercnv&quot;), ref_group_names=c(&quot;Microglia/Macrophage&quot;,&quot;Oligodendrocytes (non-malignant)&quot;)) infercnv_obj = infercnv::run(infercnv_obj, cutoff=1, # cutoff=1 works well for Smart-seq2, and cutoff=0.1 works well for 10x Genomics out_dir=tempfile(), cluster_by_groups=TRUE, denoise=TRUE, HMM=TRUE) If you can run the getting started part with demo data provided by inferCNV, then it is installed successfully. Demo Example Figure Demo Example Figure 5.2 Application on TNBC1 5.2.1 data description 5.2.2 run inferCNV ################# ##HUANG Rongting ##2021-0629 ################# ## load the package library(Seurat) library(infercnv) ## prepare the data ### load count matrix matrix_path &lt;- &quot;/groups/cgsd/yuanhua/CPOS_Data_20210317/10X5RNA_SS-181003-01a/cellranger/GX001_1m30/count_GX001_1m30/outs/filtered_gene_bc_matrices/GRCh38/&quot; anno_file &lt;- &#39;/groups/cgsd/rthuang/processed_data/inferCNV/GX001/gx001_celltype&#39; gene_file &lt;- &#39;/groups/cgsd/rthuang/processed_data/inferCNV/hg38/gene_note_noheader_unique.txt&#39; ### read count matrix gex_mtx &lt;- Seurat::Read10X(data.dir = matrix_path) ### run inferCNV with loop # cells = c(&#39;Chief&#39;, &#39;M&#39;, &#39;unclassified&#39;)#gx109 celltype = c(&#39;Enterocyte&#39;, &#39;PMC&#39;, &#39;Stem&#39;, &#39;Tuft&#39;, &#39;unclassified&#39;) for (i in celltype){ infercnv_obj1 = CreateInfercnvObject(raw_counts_matrix=gex_mtx, annotations_file=anno_file, delim=&#39;\\t&#39;, gene_order_file=gene_file, ref_group_names=c(i)) output &lt;- paste0(&#39;/groups/cgsd/rthuang/processed_data/inferCNV/GX001/&#39;,&#39;gx001_&#39;, i) infercnv_obj1 = infercnv::run(infercnv_obj1, cutoff=0.1, out_dir= output , cluster_by_groups=T, denoise=T, HMM=T) } 5.2.3 inferCNV result 5.2.4 BAF visualization 5.3 ref https://www.r-bloggers.com/2012/04/getting-started-with-jags-rjags-and-bayesian-modelling/ "],["nuclear-snv-analysis-in-single-cell-omics.html", "Chapter 6 Nuclear SNV analysis in single-cell omics", " Chapter 6 Nuclear SNV analysis in single-cell omics We have finished a nice book. "],["references.html", "References", " References "]]
